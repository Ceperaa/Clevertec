plugins {
    id 'groovy'
    id 'java'
    id 'war'

}

group 'ru.clevertec'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    compile 'org.codehaus.groovy:groovy-all:2.3.11'
    testCompile group: 'junit', name: 'junit', version: '4.12'
    implementation group: 'org.springframework', name: 'spring-webmvc', version: '5.2.22.RELEASE'
    compileOnly group: 'javax.servlet', name: 'javax.servlet-api', version: '4.0.1'
    implementation group: 'io.springfox', name: 'springfox-swagger2', version: '2.9.2'
    implementation group: 'io.springfox', name: 'springfox-swagger-ui', version: '2.9.2'
    implementation group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: '2.13.3'
    implementation group: 'org.slf4j', name: 'slf4j-api', version: '1.7.36'
    testImplementation group: 'org.slf4j', name: 'slf4j-simple', version: '1.7.36'
    implementation group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.17.0'
    //compileOnly group: 'javax.servlet', name: 'servlet-api', version: '2.5'
    implementation group: 'org.hibernate.validator', name: 'hibernate-validator', version: '7.0.4.Final'

}

class FileDownLoader extends DefaultTask {
    @Input
    String sourceUrl
    @OutputFile
    File target

    @TaskAction
    void download() {
        try {
            ant.get(src: sourceUrl, dest: target)
        } catch (Exception e) {
            print e
        }
    }
}

task downloadJKSFromNotProd(type: FileDownLoader) {
    sourceUrl = "https://raw.githubusercontent.com/Ceperaa/Clevertec/gradleTask/Cash%20register/src/main/java/ru/clevertec/check/runner/streamIO/files/CheckFile.CSV"
    target = new File('E:\\Clevertec\\Cash register\\src\\main\\java\\ru\\clevertec\\check\\runner\\streamIO\\files\\CheckFile.CSV')
}
build.dependsOn downloadJKSFromNotProd
